"use strict";

var { JWE } = require("./index.js");
const fs = require("fs");
const jsonheader = Buffer.from(fs.readFileSync("jsonheader.json", { encoding: "utf-8" }));

const jsonpayload = Buffer.from(fs.readFileSync("jsonpayload.json", { encoding: "utf-8" }));
const publicPEM = Buffer.from(fs.readFileSync("public.pem", { encoding: "utf-8" }));
const privatePEM = Buffer.from(fs.readFileSync("private.pem", { encoding: "utf-8" }));

console.log("import local json payload");

var encrypted = JWE.encrypt(jsonheader, publicPEM);
console.log("\nencrypted JWE = \n" + encrypted);

// encrypted = "eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiY3R5IjoianNvbiIsInR5cCI6IkpXVCJ9.hOeDhTOy4xbWkqLFwyFJeqxBNLtH3Oyg57c9Nksg1Sh3BrU0Oac6ks9nB-MY0f52u2uAohqCp6TbzSqKZhZWe3ZOIhP6EN9eRYhDmGFsMCfDPtUTVyGDfErIVk6IkxNpj7qj4BOBTMSLBEoF5BxJDuw_CfQnrQ1l986iycAmjohWt1LqwM14n33KABAh-5LvihVOfECJ7WaB5jonb3D8m6GS36lc8KQ55rhYhnIE2t9Xi2HeOz5NwDmuUIEcSQXrXTjvuMu2XZMimSzuW2FRYvSj6ii38_dgrJrWRjY6hBXCy9kDErmesLoonKUXw13YI9cySo7Q02BzZYIPUPkTww.90QvM-piXas0WAdYtBZPmA.Aeqy3_FbmXxwXhrIcA7o_a5Flo8RciVz_C1xwh-CidTIIxCbIvohOxYskpEpqaD3yzhM-US_uIHfoHwUaQ-iT8QJttMHPosI_7r3zQOaQVCHImlDMFWYT3S1X6HoZrrG.7vBTEsLkkC17FesvOVTBjQ";

// this is from TU mark with 1st attempt
// encrypted = "eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAtMjU2In0.pOd0HV58E4kKh-L-LnL68X3PAD1SpMkOaaYFUegdWVjG3QK2bsYqE5v32crW32zVEGiyeD1uf-qGlIPof_5e-96ARU_LBkyKZvaqNSJ9ib19qfX4dYb1KrFuScgxhOfTjLRPwilT7J4MRiqjHK3z4iSQJfvKbnrZZwtunzTTpmg.grwdYHbX1gbNfvxO0uRu5w.QO6m_RioU8eWTRIEPmmBN8jtwsP06L5bnfjeMB6kJStSqDKVf5oGXyA3M-pCQUR0V7Vtfu-GUdhi8th24LQ-zKoYw9LH_fVOac6PSzu8FShCayt8_O6b9CzIvInMHENNseM91HK7BxUpx0ImRlfkszeSSFiCuZrQK50MWy1-bpWz7XBU___jaCiXqVtQhoY7T0SeC2JHAlnJzmI3CYpBrWnrOhjylzShVLH1kIPkqGXjgRUvrRfczMI4LgBSUGZ0WwCAwMkIGZzzmDjF73d9Hs0F-LMeYHIF-IzDI-LtP522ZPdPyWodFWnJKlgQSNMSuXtMmv3fE2T9v3UvNRlgk8Fqf2qaxovyEnd-jS6EmAoKVo5LOrzTm3itGhSVb-_W_dcYSyfxiS7t68lMXwwl655Qu8cJP2LEPfYeiBYYIu5s7SW49eZmmplpzfRbjdvRmvBfXwTooNsbRn-atfM7QdjMi1ZvC9jcGMCdwlpBUghRNqJ0EKfJfscnLEQs5MEoCPQlf84UWzdoH1RWCLB18zFpetseHWHvQpEyi2XhLt6wbiSAQFq6zCIChJ6LQsjQZxV3No7ZvQv7m91HSJEKsET2HmEOPu33WpRXNtbR41ooeHnjPegn4vLl6ElozEb_VqoW6m6XwSgHqcDqyRqluwOMkL8Uy59pkP6G-rYLGmaZOkA0kOhPQMh8YZ9yBuvIDRQmXWwX0rX-9FjT_EQH35PvBmmOSbD5hItlN9qjCgkyXHnAn2sgK8Jsg4NMLIqlt9Kb5tZWasJVDYWk4_vby26N53ouLlq6aqGaXOBNXybhzj8QVhJNqilOZS_Ngt-Ocn4MN8uD3hYBDfVlqzCM84yq9WGmeVKx1vmVKMCBXyEdX5MPGJd2WZIjFfKpzV1oWqKFZK-kMBlBXX9ZjBHGo2RHIMrvAJqbMXDmHS_8zC_MlVZG2LC4vNrF748vp0-YDDloF77l9W_BiflrgH0ZiHQnnZ0FJakEu5iS2NRQJG_FcJPBUlBa8HO2n1oPHGSDp639FlG7QrTwIQrNWCm0qu0J9Xet93mG_AvfMi8QCnHP7sqNwkdUwgEUcFEAC_vM2dH9nLmFPIU5Mp09DGtL8KHCpCWF-aL2xSJcOhXP1flm2dqN-0DwgAp6NvTlfaCcVUMI-Yydp0YvbJpMHX5KjHsqssyaC83Cnyj2_-NHjzOKX1nMG0UOxVfZvWFDBTRPBioOyw5Q4YPG79mhUIE8rXMC8R-wNQB9MMJ6kPOG6XHXTpVL0n342eLO29S5-QBeK71zfQlchyrHYcjUH23ThDzs177HFUEiommjG-KpsMXDMdqgrFGbv758f6dzI3YpwEBPBV_AmKLOn9YyzS-fD0lB5RficYAJYLAIxRVVguXJFGkNBKVvXTNJR82WEjlKR-k27EjKN0kYQFaWlPS-6SlcdaAHeYdy5tjlPjJEJG_uQKndzB98cOjVpXwlNbgDEIVUFwNibeYvzwlrl5y0BsdDTPqx0JIe7G6wlSyuR6tcviaFBxNeb7kd2KzR3YkRRBIpp6FrO6ZgnUzAhGGL9LvCGHXSGfYrkisXyhJHfg4Hb_70Zczd4U77FuvCN8-Qkup1cLKDJfDluRAhC4TJD4w7a7nU3OchmLfAAaVr_aO3d2AiVyzv7Goi5V6QZs6adlG4P1dj6kITKsWy_9mVE0n_uGNbYfNDHCQe84KW6LfHE27_qfLymK8HUVZXjJ82quU-nJtbSuKnePmukFNu5hAOAbMDvOmeZC1dtAieav63eHoZxX_Dd_dJYsHhozEhuGpiLvaH-PaOyvCPwOO_WTgq7s0G4wN5ZoSVj97fXTaIC9RajWmLXxy2nbwxRiyg.SR7RLbh44l3_V6_1xgI-pg";

// this is another one generated by the site using enc a128bcbc-hs256
// var encrypted = "eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAtMjU2In0.GtXnx97XkYlso-2bp7g84JFZu9zPfidgFl3_a4XQSx7zKsnVzS9ViZCoCBAu--c_I5ltq--dJNduRiBanUo8ge-eXw9w60Fi0Vfnekex-zMHn89Jslp0qC6huN5Xcv-3S7nJXfmR-SLrdprsO3pxUkwX_HNDADoBn5LU0oPtmc-FSaeAh7An-Qsmt0AsiRDclQz-aaJRELgcMoK_2XcjEy-kzxGWLBOczSODyZKKOc_IL5v33L9VDGoorH-QOM4cUnLIP2JzmQYUVNa2KAoJYd41fu9IDR_DUPpRoSy8LUJYSd9QgcHsOUSahkp0AWg11TSNsOpXjTVeXkiwLl0QBw.RK0m-jjQkadX-TBwoIezRw.ZGX18zCZdWE6mWJ44ykyj7dl3SheSyZDv2cLKFsQdOdg5U08dmOZgZtofCTL3ZQcAQ3ZmM_EU7fsFD8l9DpRtxJHHQFf_MTC6lS7-Np5qglJewqJbkzpTHRpMZskumiqXZEYo710u-lpWRKrUypf-MWkW65Y43sPfGuNYELhmVkU6EWQvckA5OBnT2ldexkkd1cLjakXF-EiwCwNJN7L8_Tz4M4eQkU24TD28ijKJMhuPsozY8mq-b9hNEd1p5JKwnFm_My6UhqbcaGEmXk_qvN_iBvB3fCBcQHKNCfCLjwyX9rJqPYRFn0CYUxDKWYlj-gd-ZXJXRjjMk-ZAghYMzZPeFPagD6SCfaGQr2zrppnIYQ8oCuLoiaw3coo_Rd7R8YOCTeWqWXKK7X-N3lVsXnwEjeaJ69RBFUVBxfbFBXnQ-J_9gWzkDMtOuHzqtmCMIK589gPuoo03r9EqfbH2wLVRS4aM4LkNMmIhwcEv7--4STEFmxrOnO1bFTN_5H2zrGSQiyBFgHbApku9GdNDDKVVzteg7dpacak3O5xD9U.mMxMs1hm58EcUCoj7aFFog";

// another sample from mark, use the right key and jwe payload is unencrypted jwt
// encrypted = "eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAtMjU2In0.h7A01b1U3xwZrSuSEeY18MEgMRKa8W0eW7ghNVYkn3ih8jhi-w-N1DHIyJ_BvaDfESokjqA12n2nhCvGp2EE3DookcXxW_rF5PsxHndjJeDy0s_jELVV_iela-ObvFFW2rIkKm3YNMsQpTkhui9CjUWTbSM-ZeCnZilGP3Z5YnRGFOX1OlHmAlPNwUgUn7jn3BP0pPaybwG4uYumEGATsCDDbE-fQ-M8f3WYDLOxlefvJZTZuv67piDozOlC86CoggyuI1gR3L1YopBQNys9LWY6OWO1O5J7PXK33WJTwmeNXZvV-pceouTn24_xY3rKb8RmW2ECJMRfHCK37eeHrg.BGg2Kn_9fmGcGRLhcqM2Jg.WVGY9k0XjbNysZSkZlNome7NAQmO-uZg3N3p8lD_mQYIY80r1eFOwJ24r52E2YLk8BiyoXuKB1ditAyJP8iBu-Mdk99h_vAzq4-0jXeuHUO7Bb3Tq3lkzGBwkxhFF-aVUdgk7rSUlx2CDCOKQmGl5UQSbai57Z80aecW-sDunS5OO37Xb-r9k2BhCnwSbwCpXq8gnOnlbQLEM6IU6R2E_uh6s4_lv8eT_hGQbQjL_bquz3Qr4OTUOPILmB-XRPr1aLrH_X2mriNG2OjN3bPyv8Ce19m1WUYedHVk6Z242RMDkZRw_lA7NQ_CMkoWxyoiRA8vx902WftWJLjrq9Jqya8GddAr7lX99Cqd5dyovlmXnWvFQEHt3A-bYh7-Vpnu_1D7yAD0Pl6NcTdrWeMrgRoFIUOVuF3EUPOTTZ-ja-1zP4S936hm82r7AKY1zFSc_c-OOHXqEJ1FdcdTtNxrhjS96k5tLgyZ50xSY_7EFnfJ5E__SuWhTsMqwtYtN6bqdVX5u58zQpyredfNNd_ppW7xbInAM0dQHXluvnAq9EqjWuy6j3E_h33R_MJYxpd791r3kSEGx0QEEnUKHo530MkljJ6_eixf4p6UruV09LCQ-69r5W9zo82kymhoN6fzzop-R2aFvrfBf0olaR5L3dJRPLN9Rro0i1DP-N8ql3y0yi8Rl7NcxXhQwUWwOmTFT56sa3GFyD-ItiUo48M46wj1SonewHkt0DHf5JgR1r0KoP0ligameGsYmrY6NQRWrkJHOfPRhld0EBz-MJufDLc3tkH6M5G12lnGBGSPiextnyndVCnZTjO1lHNsAYW-X2WaAxBwJZU7PIQT2M5_v0tky6n5zGpm2aiVFPqIL1CQHOntJ6NUwoJFrXFTXGZPBPuALANFpZ-8lI66VnTbAnuO9vScCjdDCFw4535fISEj1twBHM4lMmUBU3KdCMnOhFYGcqgR1IYkiRmHnjR-GitInzmbqSAgbsNlCtaJl-1AzSS2xS_d2YYaDkNK8o5hwzgg4WPAg1YQW3u8JJCAM1iV-hu_bU92Bk1JVRRjIbgHfObtEz0OXtEL64gHm1vr6-Jt3soazotnQbTdWfKCtZzpWR_Gpf9ZCOS4TlAghnPpJRcaOuTAeOI98sA5VXfuE87tZBrioybXyBF4NSsU57dpUfSzAdSWegbwI5oog8LA9cPoJcmZthK_mBQ7iEw5CjXwJRswd59CSZQXTUlq2rmUkk7Bzf3Nylo7lzzffz6P2zWNzcmdAXzHWGIqTnN5MXvF2SG4WMAFSfY3OewSMbczowoxn15d7wmPRWr6bt5Eq8P4trXzxsTZOyZEstzbPxSDXSWoVPEKbZ70WGpJglECFYh6mzVB8dlHWxT1UHW-BL9Y7qmavh8VsAgicWDUvTbkGT6moqGSS7XYE8KXQNT9TrhN7M22hjk8ksxNCz3mODTsKC9JgYoY-fWsA2j0nfngVmmj7P8SLB6w0QhLzE8mQoH7hCXhJ07hAoO7MvXdZTJihE9X1YJ7ZsEJ-pgxNN4OA_KOzvilIWZLUhSkrExbc7ZAQt6fm8155uE6GfP8bGKEWco3_jsp7SQwXvRMfrzrs4RV1x-q336Un8XB-b0lMbOQWMhxy00PbdDsFnfNHSFWZKuVmN2Znqqi1BOmj0ruPpBXDXWW_VmvxDblpgJzNs5mc8VSipvbRgTtU9HSx3EpIxocG2WnT4MAgQAjOdH9ve_gT8kFTGOWJVa0sKPUkd_wRyDe263P1e8isdHupx4-dBqtUSnxlVbNQ6zuZ3BvwcpxWh5Uskbl0dw7KEIz0_kM47OpyIHyJd7IaFNF82foBbpSuzws7N4ya9aW.yZZCy4HcC_rzpnh7JDQOr";
// var encrypted = "eyJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwiYWxnIjoiUlNBLU9BRVAtMjU2In0.h7A01b1U3xwZrSuSEeY18MEgMRKa8W0eW7ghNVYkn3ih8jhi-w-N1DHIyJ_BvaDfESokjqA12n2nhCvGp2EE3DookcXxW_rF5PsxHndjJeDy0s_jELVV_iela-ObvFFW2rIkKm3YNMsQpTkhui9CjUWTbSM-ZeCnZilGP3Z5YnRGFOX1OlHmAlPNwUgUn7jn3BP0pPaybwG4uYumEGATsCDDbE-fQ-M8f3WYDLOxlefvJZTZuv67piDozOlC86CoggyuI1gR3L1YopBQNys9LWY6OWO1O5J7PXK33WJTwmeNXZvV-pceouTn24_xY3rKb8RmW2ECJMRfHCK37eeHrg.BGg2Kn_9fmGcGRLhcqM2Jg.WVGY9k0XjbNysZSkZlNome7NAQmO-uZg3N3p8lD_mQYIY80r1eFOwJ24r52E2YLk8BiyoXuKB1ditAyJP8iBu-Mdk99h_vAzq4-0jXeuHUO7Bb3Tq3lkzGBwkxhFF-aVUdgk7rSUlx2CDCOKQmGl5UQSbai57Z80aecW-sDunS5OO37Xb-r9k2BhCnwSbwCpXq8gnOnlbQLEM6IU6R2E_uh6s4_lv8eT_hGQbQjL_bquz3Qr4OTUOPILmB-XRPr1aLrH_X2mriNG2OjN3bPyv8Ce19m1WUYedHVk6Z242RMDkZRw_lA7NQ_CMkoWxyoiRA8vx902WftWJLjrq9Jqya8GddAr7lX99Cqd5dyovlmXnWvFQEHt3A-bYh7-Vpnu_1D7yAD0Pl6NcTdrWeMrgRoFIUOVuF3EUPOTTZ-ja-1zP4S936hm82r7AKY1zFSc_c-OOHXqEJ1FdcdTtNxrhjS96k5tLgyZ50xSY_7EFnfJ5E__SuWhTsMqwtYtN6bqdVX5u58zQpyredfNNd_ppW7xbInAM0dQHXluvnAq9EqjWuy6j3E_h33R_MJYxpd791r3kSEGx0QEEnUKHo530MkljJ6_eixf4p6UruV09LCQ-69r5W9zo82kymhoN6fzzop-R2aFvrfBf0olaR5L3dJRPLN9Rro0i1DP-N8ql3y0yi8Rl7NcxXhQwUWwOmTFT56sa3GFyD-ItiUo48M46wj1SonewHkt0DHf5JgR1r0KoP0ligameGsYmrY6NQRWrkJHOfPRhld0EBz-MJufDLc3tkH6M5G12lnGBGSPiextnyndVCnZTjO1lHNsAYW-X2WaAxBwJZU7PIQT2M5_v0tky6n5zGpm2aiVFPqIL1CQHOntJ6NUwoJFrXFTXGZPBPuALANFpZ-8lI66VnTbAnuO9vScCjdDCFw4535fISEj1twBHM4lMmUBU3KdCMnOhFYGcqgR1IYkiRmHnjR-GitInzmbqSAgbsNlCtaJl-1AzSS2xS_d2YYaDkNK8o5hwzgg4WPAg1YQW3u8JJCAM1iV-hu_bU92Bk1JVRRjIbgHfObtEz0OXtEL64gHm1vr6-Jt3soazotnQbTdWfKCtZzpWR_Gpf9ZCOS4TlAghnPpJRcaOuTAeOI98sA5VXfuE87tZBrioybXyBF4NSsU57dpUfSzAdSWegbwI5oog8LA9cPoJcmZthK_mBQ7iEw5CjXwJRswd59CSZQXTUlq2rmUkk7Bzf3Nylo7lzzffz6P2zWNzcmdAXzHWGIqTnN5MXvF2SG4WMAFSfY3OewSMbczowoxn15d7wmPRWr6bt5Eq8P4trXzxsTZOyZEstzbPxSDXSWoVPEKbZ70WGpJglECFYh6mzVB8dlHWxT1UHW-BL9Y7qmavh8VsAgicWDUvTbkGT6moqGSS7XYE8KXQNT9TrhN7M22hjk8ksxNCz3mODTsKC9JgYoY-fWsA2j0nfngVmmj7P8SLB6w0QhLzE8mQoH7hCXhJ07hAoO7MvXdZTJihE9X1YJ7ZsEJ-pgxNN4OA_KOzvilIWZLUhSkrExbc7ZAQt6fm8155uE6GfP8bGKEWco3_jsp7SQwXvRMfrzrs4RV1x-q336Un8XB-b0lMbOQWMhxy00PbdDsFnfNHSFWZKuVmN2Znqqi1BOmj0ruPpBXDXWW_VmvxDblpgJzNs5mc8VSipvbRgTtU9HSx3EpIxocG2WnT4MAgQAjOdH9ve_gT8kFTGOWJVa0sKPUkd_wRyDe263P1e8isdHupx4-dBqtUSnxlVbNQ6zuZ3BvwcpxWh5Uskbl0dw7KEIz0_kM47OpyIHyJd7IaFNF82foBbpSuzws7N4ya9aW.yZZCy4HcC_rzpnh7JDQOrA";
var decrypted = JWE.decrypt(encrypted, privatePEM);
console.log("\ndecrypted JWE and payload = \n" + decrypted);

